---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const posts = (await getCollection('posts'))
  .filter(post => !post.data.draft)
  .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<BaseLayout title="Personal Blog">
  <section>
    <h1>Welcome to My Blog</h1>
    <p>A place where I share my thoughts and ideas.</p>
  </section>

  <section>
    <h2>Latest Posts</h2>
    
    {posts.length === 0 ? (
      <p>No posts yet. Add markdown files to <code>src/content/posts/</code></p>
    ) : (
      <ul class="post-list">
        {posts.map((post) => (
          <li>
            <a href={`/posts/${post.slug}/`}>
              <h3>{post.data.title}</h3>
              <time datetime={post.data.pubDate.toISOString()}>
                {post.data.pubDate.toLocaleDateString('en-US', {
                  year: 'numeric',
                  month: 'long',
                  day: 'numeric',
                })}
              </time>
              <p>{post.data.description}</p>
            </a>
          </li>
        ))}
      </ul>
    )}
  </section>
</BaseLayout>

<style>
  .post-list {
    list-style: none;
    padding: 0;
  }
  
  .post-list li {
    margin-bottom: 1.5rem;
    padding: 1rem;
    background: white;
    border-radius: 8px;
    box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    transition: transform 0.2s;
  }
  
  .post-list li:hover {
    transform: translateY(-2px);
  }
  
  .post-list a {
    text-decoration: none;
    color: inherit;
  }
  
  .post-list h3 {
    margin: 0 0 0.5rem 0;
    color: #333;
  }
  
  .post-list time {
    color: #666;
    font-size: 0.9rem;
  }
  
  .post-list p {
    margin: 0.5rem 0 0 0;
    color: #555;
  }
</style>
